<!--

    Copyright (C) 2014 Ontology Engineering Group, Universidad PolitÃ©cnica de Madrid (http://www.oeg-upm.net/)

    Licensed under the Apache License, Version 2.0 (the "License");
    you may not use this file except in compliance with the License.
    You may obtain a copy of the License at

            http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.

-->
<html>
<head>
    <meta charset="utf-8">
    <title>LDP4j Test Client </title>

    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">
    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap-theme.min.css">

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css">

    <!-- Bootstrap validator -->
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/jquery.bootstrapvalidator/0.5.3/css/bootstrapValidator.min.css"/>

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>

<body>

<div class="container">

    <!-- Main jumbotron for a primary marketing message or call to action -->
    <div class="jumbotron">
        <div class="container">
            <h2>LDP4j Client</h2>

            <p>bla bla bla.</p>
        </div>
    </div>

    <div class="row">
        <div class="container">
            <div id="content">
                <ul id="tabs" class="nav nav-tabs" data-tabs="tabs">
                    <li class="active"><a href="#read" data-toggle="tab">Retrieve</a></li>
                    <li><a href="#update" data-toggle="tab">Update</a></li>
                    <li><a href="#create" data-toggle="tab">Create</a></li>
                    <li><a href="#delete" data-toggle="tab">Delete</a></li>
                </ul>
                <div id="my-tab-content" class="tab-content">
                    <div class="tab-pane active" id="read">
                        <h1>Retrieve an LDP resource (or a container)</h1>

                        <div>
                                <div class="form-group">
                                    <div class="col-xs-8">
                                        <label for="get_url">URL</label>
                                        <input class="form-control" id="get_url" type="text">
                                    </div>
                                    <div class="col-xs-2 form-inline">
                                        <label for="get_contentType">RDF Format</label>
                                        <br/>
                                        <select name="contentType" id="get_contentType">
                                            <option value="text/turtle">Turtle</option>
                                            <option value="application/rdf+xml">RDF/XML</option>
                                            <option value="application/ld+json">JSON-LD</option>
                                        </select>
                                    </div>
                                    <div class="col-xs-2 form-inline">
                                        <label for="get_button">Action</label>
                                        <br/>
                                        <button id="get_button" name="get_button" class="btn btn-success"
                                               onclick="getLDPR()">GET</button>
                                    </div>
                                </div>
                        </div>
                        <h3>Response:</h3>
                        <div>
                            <form>
                                <textarea class="form-control col-xs-12" disabled id="get_response" rows="15"></textarea>


                            </form>

                            <div >
                                <pre id="get_headers"></pre>
                            </div>

                        </div>

                    </div>
                    <div class="tab-pane" id="update">
                        <h1>Update an LDP resource (or a container)</h1>
                        <div>
                            <div class="form-group">
                                <div class="col-xs-6">
                                    <label for="put_url">URL</label>
                                    <input class="form-control" id="put_url" type="text">
                                </div>
                                <div class="col-xs-2 form-inline">
                                    <label for="put_contentType">RDF Format</label>
                                    <br/>
                                    <select name="put_contentType" id="put_contentType">
                                        <option value="text/turtle">Turtle</option>
                                        <option value="application/rdf+xml">RDF/XML</option>
                                        <option value="application/ld+json">JSON-LD</option>
                                    </select>
                                </div>
                                <div class="col-xs-2 form-inline">
                                    <label for="put_get_btn">Action</label>
                                    <br/>
                                    <button id="put_get_btn" name="put_get_btn" class="btn btn-warning"
                                            onclick="getForUpdating()">GET</button>
                                </div>
                                <div class="col-xs-2 form-inline">
                                    <label for="put_update_btn">Action</label>
                                    <br/>
                                    <button id="put_update_btn" name="put_update_btn" class="btn btn-success"
                                            onclick="update()">PUT</button>
                                </div>
                            </div>
                        </div>
                        <h3>Response:</h3>
                        <div class="row">

                            <form class="form-horizontal">
                                <div class="form-group row">
                                    <label for="put_etag" class="control-label col-xs-4">Email</label>
                                    <div class="col-xs-8">
                                        <input class="form-control" id="put_etag" placeholder="Entity tag">
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <label for="put_body" class="control-label row">Resource Content</label>
                                    <div class="col-xs-4">
                                        <textarea class="form-control row" id="put_body" rows="15"></textarea>
                                    </div>
                                </div>
                            </form>

                        </div>

                        <div>
                            <div id="update_response">
                                <textarea class="form-control col-xs-12" disabled id="update_response"
                                          rows="15" style="visibility: hidden"></textarea>
                                <pre id="update_status"></pre>
                                <pre id="update_headers"></pre>
                            </div>
                        </div>

                    </div>
                    <div class="tab-pane" id="create">
                        <h1>Create an LDP resource (or a container)</h1>
                        <p>yellow yellow yellow yellow yellow</p>
                    </div>
                    <div class="tab-pane" id="delete">
                        <h1>Delete an LDP resource (or a container)</h1>
                        <p>green green green green green</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
<!-- Bootstrap validator -->
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/jquery.bootstrapvalidator/0.5.3/js/bootstrapValidator.min.js"></script>
<!-- TODO check for a way to auto resize the text area -->
<!--script src="js/jquery.autosize.js"></script-->

<script>

    function getLDPR() {
        var url = document.getElementById('get_url');
        var contentType = document.getElementById('get_contentType');
        console.log("URL: " + url.value);
        console.log("Content Type: " + contentType.value);

        $.ajax({
            type: "GET",
            url: url.value,
            headers: {
                Accept : contentType.value
            },
            success: function (data, textStatus, xhr) {
                document.getElementById("get_response").value = xhr.responseText;
                document.getElementById("get_headers").textContent = xhr.getAllResponseHeaders();
            }
        });
    }

    function getForUpdating() {
        var url = document.getElementById('put_url');
        var contentType = document.getElementById('put_contentType');

        $.ajax({
            type: "GET",
            url: url.value,
            headers: {
                Accept : contentType.value
            },
            success: function (data, textStatus, xhr) {
                document.getElementById("put_body").value = xhr.responseText;
                document.getElementById("put_etag").value = xhr.getResponseHeader("ETag");
                contentType.disabled=true;
            }
        });
    }

    function update(){
        var url = document.getElementById('put_url');
        var contentType = document.getElementById('put_contentType');
        var body = document.getElementById("put_body");
        var etag = document.getElementById("put_etag");

        $.ajax({
            type: "PUT",
            url: url.value,
            data: body.value,
            contentType: contentType.value,
            headers: {
                'If-Match' : etag.value
            },
            success: function (data, textStatus, xhr) {
                console.log(textStatus);
                if(xhr.responseText){
                    var response = document.getElementById("update_response");
                    response.style.visibility = 'visible';
                    response.value = xhr.responseText;
                }

                document.getElementById("update_status").textContent = xhr.status + ' ' + textStatus ;
                document.getElementById("update_headers").textContent = xhr.getAllResponseHeaders();
            },
            error: function (xhr, textStatus, errorThrown) {
                if(xhr.responseText){
                    var response = document.getElementById("update_response");
                    response.style.visibility = 'visible';
                    response.value = errorThrown;
                }

                document.getElementById("update_status").textContent = xhr.status + ' ' + textStatus ;
                document.getElementById("update_headers").textContent = xhr.getAllResponseHeaders();
            }
        });

    }

</script>

</body>
</html>

